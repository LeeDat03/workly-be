version: "3.9"

services:
    redis:
        image: redis:7.2-alpine
        container_name: search-redis
        restart: unless-stopped
        ports:
            - "6379:6379"
        command: redis-server --save 60 1 --loglevel warning
        volumes:
            - redis-data:/data

    # elasticsearch:
    #     image: docker.elastic.co/elasticsearch/elasticsearch:7.17.0
    #     container_name: search-elasticsearch
    #     restart: unless-stopped
    #     environment:
    #         - discovery.type=single-node
    #         - bootstrap.memory_lock=true
    #         - ES_JAVA_OPTS=-Xms2g -Xmx2g
    #         - xpack.security.enabled=false
    #     ulimits:
    #         memlock: -1
    #         nofile: 65536
    #     volumes:
    #         - elasticsearch-data:/usr/share/elasticsearch/data
    #     ports:
    #         - "9200:9200"

    rabbitmq:
        image: rabbitmq:3.13-management
        container_name: search-rabbitmq
        restart: unless-stopped
        ports:
            - "5672:5672" # cá»•ng AMQP
            - "15672:15672" # dashboard UI
        environment:
            - RABBITMQ_DEFAULT_USER=admin
            - RABBITMQ_DEFAULT_PASS=admin
        volumes:
            - rabbitmq-data:/var/lib/rabbitmq

    # kibana:
    #   image: docker.elastic.co/kibana/kibana:7.17.0
    #   ports:
    #     - "5601:5601"
    #   environment:
    #     ELASTICSEARCH_HOSTS: "http://elasticsearch:9200"
    #   depends_on:
    #     - elasticsearch
volumes:
    redis-data:
    elasticsearch-data:
    rabbitmq-data:
